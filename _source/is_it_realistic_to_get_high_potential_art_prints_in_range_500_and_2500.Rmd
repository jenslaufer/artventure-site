---
title: "Is it realistic to get high potential prints in a price range of 500-2500?"
author: "Jens Laufer"
date: "5 3 2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, message = F)
```

```{r}
source("R/data.R")
source("R/vis.R")
```

```{r}
library(emojifont)
```





```{r}
df <- data.frame(
  x = rep(seq(2, 15, 6.5)),
  y = rep(6.5, 3),
  h = rep(6, 3),
  w = rep(9, 3),
  value = c(
    paste0("+", round(totalArtpieces / 1000, 0), "k"),
    paste0("+", round(totalNumPrintArts / 1000, 0), "k"),
    paste0("+", round(totalNumPrintArtsWithPricing / 1000, 0), "k")
  ),
  info = c("Art Pieces",
           "Print Arts",
           "Print Arts"),
  shape = rep(fontawesome(search_fontawesome("chart")[1]),3),
  font_family = rep("fontawesome-webfont", 3),
  color = factor(1:3)
)

ggplot(df, aes(x,
               y,
               height = h,
               width = w)) +
  geom_tile(aes(fill = color)) +
  geom_text(
    color = "white",
    fontface = "bold",
    size = 10,
    aes(label = value, x = x - 4, y = y + 1),
    hjust = 0
  ) +
  geom_text(
    color = "white",
    fontface = "bold",
    size = 4,
    aes(label = info, x = x - 4, y = y - 1),
    hjust = 0
  ) +
  geom_text(
    size = 20,
    aes(
      label = shape,
      family = font_family
    ),
    alpha = 0.25
  ) +
  scale_fill_brewer(type = "qual", palette = "Dark2") +
  coord_fixed() +
  theme_void() +
  guides(fill = FALSE)
```



## Is it realistic to get high potential Print Art pieces in the range of $500-$2500?



```{r}
totalNumPrintArts %>% 
  valueBox(totalNumPrintArts, "tachometer", "#ff9999")
```

I first filter all `r totalNumPrintArts` `r totalNumPrintArtsWithPricing`



```{r}
priceBucketData <- printArtData %>%
  mutate(original_price_bucket = cut(original_price, c(
    min(original_price), 500, 2500, 5000, max(original_price) + 1
  )),
  include.lowest = T) %>%
  drop_na(original_price_bucket)

priceBucketData %>%
  ggplot(aes(x = original_price_bucket, y = priceIncreasePercentage)) +
  geom_jitter(color = "#ffbb00", alpha = .3) +
  geom_boxplot(alpha = 0.6) +
  scale_x_discrete(
    limit = priceBucketData %>% group_by(original_price_bucket) %>% summarise(median = median(priceIncreasePercentage, na.rm = T)) %>%  arrange(-median) %>% pull(original_price_bucket)
  ) +
  coord_cartesian(ylim = c(0, 1000))
```


```{r}
priceBucketData %>% 
  group_by(original_price_bucket) %>% 
  summarize(n=n())
```

```{r}
priceBucketData %>% 
  filter(original_price_bucket=="(500,2.5e+03]")
```


```{r}
priceBucketData <- printArtData %>%
  mutate(
    original_price_bucket = cut(
      original_price,
      printArtData %>% pull(original_price) %>% quantile()
    ),
    include.lowest = T
  ) %>%
  drop_na(original_price_bucket)

priceBucketData %>%
  ggplot(aes(x = original_price_bucket, y = priceIncreasePercentage)) +
  geom_jitter(color = "#ffbb00", alpha = .3) +
  geom_boxplot(alpha = 0.6) +
  scale_x_discrete(
    limit = priceBucketData %>% group_by(original_price_bucket) %>% summarise(median = median(priceIncreasePercentage, na.rm = T)) %>%  arrange(-median) %>% pull(original_price_bucket)
  ) +
  coord_cartesian(ylim = c(0, 1000))
```




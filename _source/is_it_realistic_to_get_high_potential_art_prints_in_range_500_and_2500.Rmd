---
title: "Is it realistic to get high potential prints in a price range of 500-2500?"
author: "Jens Laufer"
date: "5 3 2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F, message = F)
```

```{r}
source("R/data.R")
source("R/vis.R")
```

```{r}
printArtData <- data %>%
  filter(class=="Art Print") 
  
totalNumPrintArts <- printArtData %>% nrow()

printArtData <- data %>%
  filter(class=="Art Print") %>% 
  drop_na(original_price, lowest_price, average_price, highest_price) %>% 
  mutate(priceIncreasePercentage=(highest_price - lowest_price)/lowest_price * 100)

totalNumPrintArtsWithPricing <- printArtData %>% 
  nrow()
```


## Is it realistic to get high potential Print Art pieces in the range of $500-$2500?


I first filter all `r totalNumPrintArts` `r totalNumPrintArtsWithPricing`



```{r}
priceBucketData <- printArtData %>%
  mutate(original_price_bucket = cut(original_price, c(
    min(original_price), 500, 2500, 5000, max(original_price) + 1
  )),
  include.lowest = T) %>%
  drop_na(original_price_bucket)

priceBucketData %>%
  ggplot(aes(x = original_price_bucket, y = priceIncreasePercentage)) +
  geom_jitter(color = "#ffbb00", alpha = .3) +
  geom_boxplot(alpha = 0.6) +
  scale_x_discrete(
    limit = priceBucketData %>% group_by(original_price_bucket) %>% summarise(median = median(priceIncreasePercentage, na.rm = T)) %>%  arrange(-median) %>% pull(original_price_bucket)
  ) +
  coord_cartesian(ylim = c(0, 1000))
```

```{r}
priceBucketData <- printArtData %>%
  mutate(
    original_price_bucket = cut(
      original_price,
      printArtData %>% pull(original_price) %>% quantile()
    ),
    include.lowest = T
  ) %>%
  drop_na(original_price_bucket)

priceBucketData %>%
  ggplot(aes(x = original_price_bucket, y = priceIncreasePercentage)) +
  geom_jitter(color = "#ffbb00", alpha = .3) +
  geom_boxplot(alpha = 0.6) +
  scale_x_discrete(
    limit = priceBucketData %>% group_by(original_price_bucket) %>% summarise(median = median(priceIncreasePercentage, na.rm = T)) %>%  arrange(-median) %>% pull(original_price_bucket)
  ) +
  coord_cartesian(ylim = c(0, 1000))
```


```{r}
printArtData %>% qua
```


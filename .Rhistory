mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total*100) %>%
arrange(-n) %>%
drop_na() %>%
ungroup() %>%
ggplot(aes(x = pct, y=!!sym(var), fill=!!sym(var))) +
geom_bar(stat = "identity") +
scale_fill_tableau(palette="Tableau 20")
var <- "class"
data %>%
mutate(total = n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct = n / total * 100) %>%
arrange(-n) %>%
drop_na() %>%
ungroup() %>%
ggplot(aes(
x = !!sym(var),
y = pct,
fill = !!sym(var)
)) +
geom_bar(stat = "identity", position = "stack") +
scale_fill_tableau(palette = "Tableau 20")
var <- "class"
data %>%
mutate(total = n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct = n / total * 100) %>%
arrange(-n) %>%
drop_na() %>%
ungroup() %>%
ggplot(aes(
x = !!sym(var),
y = pct,
fill = !!sym(var)
)) +
geom_bar(stat = "identity", position = "fill") +
scale_fill_tableau(palette = "Tableau 20")
knitr::opts_chunk$set(echo = F, message = F, warning = T)
library(tidyverse)
library(glue)
library(bbplot)
library(ggthemes)
library(aws.s3)
library(knitr)
ART_DATA_URI <- "s3://artventure-8cgc8pg/art_pieces.csv"
Sys.setenv("AWS_DEFAULT_REGION" = "us-east-1")
Sys.getenv("AWS_ACCESS_KEY_ID")
data <- s3read_using(read_csv, object = ART_DATA_URI)
data %>% glimpse()
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(-n) %>%
drop_na() %>%
ungroup()
plot1 <- varData %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill="steelblue") +
geom_text(aes(label = "{pct}%" %>% glue())) +
scale_x_discrete(limit = varData %>% pull(!!sym(var))) +
coord_flip() +
labs(title='Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(-n) %>%
drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct=round(pct,1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill="steelblue") +
geom_text(aes(label = "{pct}%" %>% glue())) +
scale_x_discrete(limit = varData %>% pull(!!sym(var))) +
coord_flip() +
labs(title='Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(-n) %>%
drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct=round(pct*100,1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill="steelblue") +
geom_text(aes(label = "{pct}%" %>% glue())) +
scale_x_discrete(limit = varData %>% pull(!!sym(var))) +
coord_flip() +
labs(title='Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct=round(pct*100,1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill="steelblue") +
geom_text(aes(label = "{pct}%" %>% glue())) +
scale_x_discrete(limit = varData %>% pull(!!sym(var))) +
coord_flip() +
labs(title='Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct=round(pct*100,1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill="steelblue") +
geom_text(aes(label = "{pct}%" %>% glue()),position = position_dodge(width = 1),
vjust = -0.5) +
scale_x_discrete(limit = varData %>% pull(!!sym(var))) +
coord_flip() +
labs(title='Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
geom_text(aes(label = "{pct}%" %>% glue()),
position = position_dodge(width = 1),
vjust = 0.5) +
scale_x_discrete(limit = varData %>% pull(!!sym(var))) +
coord_flip() +
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
geom_text(aes(label = "{pct}%" %>% glue()),
position = position_dodge(width = 1),
vjust = 1.5) +
scale_x_discrete(limit = varData %>% pull(!!sym(var))) +
coord_flip() +
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
geom_text(aes(label = "{pct}%" %>% glue()),
position = position_dodge(width = 3),
vjust = 0.5) +
scale_x_discrete(limit = varData %>% pull(!!sym(var))) +
coord_flip() +
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
position = position_dodge(width = 5),
vjust = 0.5) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
vjust = 0.5) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
vjust = 1) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
hjust = 1) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
hjust = -1) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
hjust = -.5) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
hjust = -.1) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 1000,
height_pixels = 800,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
hjust = -.1) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 400,
height_pixels = 200,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
plotQual <- function(data, var) {
varData <- data %>%
mutate(total=n()) %>%
group_by(!!sym(var), total) %>%
summarise(n = n()) %>%
mutate(pct=n/total) %>%
arrange(n) %>%
#drop_na() %>%
ungroup()
plot1 <- varData %>%
mutate(pct = round(pct * 100, 1)) %>%
ggplot(aes(!!sym(var), n)) +
geom_bar(stat = "identity", fill = "steelblue") +
coord_flip() +
geom_text(aes(label = "{pct}%" %>% glue()),
hjust = -.1) +
scale_x_discrete(limit = varData %>% pull(!!sym(var)))+
labs(title = 'Number of Art PIeces for Variable "{var}"' %>% glue()) +
bbc_style()
plot1 %>%
finalise_plot(source = "Source: https://artventure.me, Data Source: https://expressobeans.com",
width_pixels = 800,
height_pixels = 400,
save_filepath = "{var}.jpg" %>% glue())
}
c("class", "status", "technique", "markings") %>%
map(~plotQual(data, ..1))
